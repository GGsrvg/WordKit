//
//  Document.cpp
//  actGenerator
//
//  Created by GGsrvg on 02.12.2021.
//

#include "Document.h"

const std::string hexEmptyTemplate = "504B03040A0000000000C5B4474A00000000000000000000000009008500646F6350726F70732F53447000C000000000080056833AB26364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C450C20096169660F8CF28CF001203A95500A905B1854520E28C107121A8DA950C42286A15416C011186FD8CC270B5DC20521AE452C607C8620055540D000721229A5821229A5821229A58504B03041400000008000265484A3E8975CE7E0100000203000010007C00646F6350726F70732F6170702E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A589D52CB4EE43010BCCF5744B9CF388376114219233468B52B2D0F69C270B6EC4E62E197EC0691BFA79D8430ECDEC8C95DD5AEAEAEB8BE7AB3A6788598B477BB72BBA9CA029CF44ABB6E573E36BFD61765915038258C77B02B0748E5155FD50FD10788A82115A4E0D2AEEC11C3256349F66045DA10ED88697DB402A98C1DF36DAB25DC78F962C1213BABAA73066F084E815A8745B09C142F5FF1BBA2CACBEC2F1D9B21901E5F1545DD800D4620F0BB7CD96C94475BB3051D5B3C0AD3680BBC22662932F5203A487C5BB3E990A1271F55CA9DD32143FB5E442191D2E43F6A765265F23A04A3A5400A9ADF6A197DF22D16F7A3FD226BD4ECB4255FA1AD0E205FA2C6210F3A2D33FD57BBC9D474987C46D14511FAD9EC5265F22085813D05C35B6112D4EC1318DD7B1B841BF81F479E0F4342B089B698D179E0737A0C8DBFC991CD225FC1AF313C69EC0F4148F82790137C344604285A6F31B60099FE4D7F319A3C86145C07EAA3ED7F620EFA383D68BEFDB9A9E81B93FDC05694CBF2D6F8EA1D504B03041400000008000265484AF37A1D4158010000CC02000011007C00646F6350726F70732F636F72652E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A589D92CF4FC2301480EFFC154BEF5B3B4844976D246A3849622246E3ADB60FA86C6DD316C6FE7BBBC12A044E1EDFDEF7BEBD1FCD6787BA8AF660AC50B2406942500492292EE4BA40EFCB797C8F22EBA8E4B452120AD48245B37294339D3165E0D5280DC609B09117499B315DA08D733AC3D8B20DD4D4269E903EB952A6A6CE87668D35655BBA063C26E40ED7E028A78EE24E18EB604427256741A977A6EA059C61A8A006E92C4E9314FFB10E4C6D6F16F49933B216AED570131D92813E5811C0A6699266D2A3BEFF147F2E5EDEFA516321BB553140E5288A72CE32275C057888ECEEFB07980B3133409D3225F01D353CC7679F3AC2AF780B6DA30CB7A18483654668E7AF8507A8A2D62DFCC55602F8631B6CD799136F602FBA7397690F85F0F88B7E4BC73E80477EEEECB8A521F331797A5ECE513926E93426E3984C97E943369966847C75235CD45F38EB5327FF960E02FFFCF0D5FB2B47BF504B03040A0000000000C5B4474A00000000000000000000000005008500776F72642F53447000C000000000080056833AB26364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C450C20096169660F8CF28CF001203A95500A905B1854520E28C107121A8DA950C42286A15416C011186FD8CC270B5DC20521AE452C607C8620055540D000721229A5821229A5821229A58504B0304140000000800046E484A10F6F65A5B0200007507000011007C00776F72642F646F63756D656E742E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000767F79A58D07BCE1221229A58AD95DF6FDB2010C7DFFB5758BCA7B6FB233FAC3A95D66E551F26454BFB3C118C6D14E0109064DD5FBFC38E1D6793AAB4D993398EFBDC973BC077F7BF948CB6DC3A013A27E9654222AE1914425739797DF9369A92C879AA0B2A41F39CBC7147EEE71777BBAC00B6515CFB0809DA653BC372527B6FB23876ACE68ABA4B25980507A5BF64A062284BC178BC035BC457499A3423638171E730DD03D55BEAC81EA7FEA581E11A9D2558453D9AB68A15B5EB8D1921DD502F56420AFF86EC64DC6120271BABB33D62D40B0A21592B68FFE922EC2979DB90C77D059A8CB1E512358076B530876D7C9686CEBA836CDFDBC45649D2B720BD39AF078F96EEF073009E22BF6883946C95BF4F4C93133A12107DC429128E73764A1415FA90F853A5191437BDFD18E0EA6F80A9CE6BCE93858D39D0C479B467BDEE59E1627F80B56FF2706BEE3C31CB9A1ABC818A65CF95064B57121561CB22AC7A148E35995F44113E3A2B28DEC2B0314CB4CBF0E12A7EE4244926E3F1ECF68174530B1B26AF66C9C324E9271F794937D20F3C2DABA52D6C6735B61DDACD8CA4BA42D496CA9C703D7A5D927810111F850473400CBCFF486F02FCFC853B1F3C7E9875987305B00E6FE4D253EB112E0ADC7B2887A60A2BFCF309BE50B63E241A847CD5451FB0F7377BEAABEF38F30B7B6A0B8685AE96BF710D5EEC349D85A77A97D5381E4FAFA7474A4CF59D06BE0713965EDF346451D5D8C0E96DB38D15780FEAE095BC44673A49D286CA69C151C4249906B304F003B3DAF8C64C8E9232900E9DCE50C6DBA5432FFEF39EAC08859142F385F00C955F8F8F2AD4D6A539AF717760C3A8FB5FCE2FFE00504B03041400000008000265484AB5D52725A90100004B05000012007C00776F72642F666F6E745461626C652E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58E5925D6BDB301486EFF32B84EE1BCB4ED276264E59D306066317A3FB018A22DBA2FA303A4ABCFCFB1DCB1F0DDB28DD06BBA905423AEFD1A3A3D7677DF7DD6872921E94B3054DE78C1269853B285B15F4DBD3EEEA961208DC1EB8765616F42C81DE6D66EB362F9D0D40F0B885DC8882D62134799280A8A5E130778DB42896CE1B1E70EBABC470FF7C6CAE84330D0F6AAFB40AE72463EC9A0E18FF168A2B4B25E4831347236D88E7132F35129D855A3530D2DAB7D05AE70F8D774202E0938DEE79862B3B61D2E52F20A38477E0CA30C7C70C1545141E4F595C19FD0258FD19209B0046E49F2AEB3CDF6BF41E2B2108A39B1921C30F206D6EB9416DCBB5DA7B15B5A836DC3A9029269CB82E28CBD88EAD70EEC6922DBA992653B6A8B90719C6ECEDF6422BB951FA3C4AD02A800BB55141D4A378E25E75B55EE8A02A548FB067057D648C651F773BDA4752BCA88B2C6FEE87488685F6DF8721B29822AC8B88C889DBB4E788C89972E2C5EBA477E777463D2923817C912DF9EA0CB7AF1996B16B346A857675C62DFED2301FAFF907C31E7F36ECE676F51F0D1B3A8B7C56551D5EEFAFC5BBEBAF71059BD90F504B03041400000008000265484AC27C1DDDC8030000FB0A000011007C00776F72642F73657474696E67732E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58B5566D73DA3810FE9E5FE1F1E723D8801DF0857408C4D77442DB09F407C8960C9AE8C523C910DAB9FF7EEB1761731952EE3AFD04DA679F7DD3EECAB71F5E39737644692AC5D4F5AF3DD7212295988ACDD4FDB68E7B63D7D106098C981464EA1E88763FDC5DDDEE234D8C012DED8005A1239E4EDDAD3179D4EFEB744B38D2D7322702C04C2A8E0C1CD5A6CF917A29F25E2A798E0C4D28A3E6D01F785EE83666E4D42D94881A133D4E5325B5CC4C49896496D194343F96A12EF15B5316322D3811A6F2D85784410C52E82DCDB5B5C6FFAF3500B7D6C8EEBD24769C59BDBDEF5D90EE5E2A7C645C125E49C8954C89D670419CD900A9681D8FDE183AFABE06DF4D8A9529A0FB5EF5AF1B79F0DF0C0CFE6540B34B32A9A1279A28A40EDD34781A3D6E84542861D094908E0311B977578E039DF95D4AEEECA39CA814AE07BADAF3DC7E836192A18299354A5646E6A0B54310C98D373E6AA45BA4506A885AE52885FACDA5304A32AB8AE56769E6D0BF0ACADB92AA862E0F9DE3AA9E10600AC421CC93AE5F4A0C2DBC8F0A452FAFA46BA38064FB3FF12661AA15C5645DD668650E8CC490C98A7E2733813F15DA50305B0DC02F84F1D3288828DD7F81AB5D1F721213640A28DCEFF4585D50CC68BEA44A49F5283034C1EFF548B38C28F04291214BE82EAAE4BE2AFB478230ECD65F767EDBEFB6180402FB1AEB6358E5E9594A63599E379878F31BAF1379A972313C1C873793F82C7C138693607E1E1E0FE70FC15978E6078BF03C7B11FBE3383C0BC741180EDF81277EF01EBC08FCE1A8ADE9B18CB73C2A17F857D510EB6339300EAFC973C4134591B32CF77CFFA896A8977B2AAC5242607B9137F0AA48AC46AFD74135478CC5B06D2CEA75404C75BE20592B604BA436ADAFAEAE3A0FC1C2FB74B45FEE43A2FE52B2C83B2A7B85F27A4CAC9E3F1A756D50619E28B7A02E92D5095FC072EEE085C05F76CA16B95B58B80F039D5F2DA227544D50C55045EFF95BBB4B995A9503429628CFEB394B36FED46574B3357E391A064E18BE24AA43B21934D8A0C20635561D505A660CDACD9F5636B0B28EDED0CA86AD6C6465A356165859D0CA422B0B4BD916769D6254BCC0C8DBBFA53C938CC93DC11F5BFC8DE85807BD453959D4EF959D75594B9B574C3BBB88BCC20B473035F09D9653CCD16BF9E00DDA1968280C1D64614E08B542A55212F3536B1819D4DD7EFD13437682DE0459BDB12985CE5E1D78D2BE9B7F1CF36254C30ACDE195355259F84F0BFB41F5029B358CC50BDCFE33C9EE9126B885B14C1F71F9DED7CC1FF7C17831F483596F380E16BDD1C32CECDDC783496F361C8FC3C564F4E08793BF4BF355BCCD57EBDDD53F504B03041400000008000265484A97A48381310C0000487F00000F007C00776F72642F7374796C65732E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58CD9DDB52E4BA1586EFF753B8FA2AB960E8133050C3DE05CC4CA0C2306C1A32D76A5B4D6B635B8E0F03E445F21AB94E55DE611E29B26C77CBBDAC767B790DC91DD8D62779E9FF252D1FDA1F7E7B097CE73B8F1321C3D3C1E8DD70E0F0D0959E081F4F070FF79FF7DE0F9C2465A1C77C19F2D3C12B4F06BFFDFACB87E793247DF579E2A8F2617212B8A783659A4627FBFB89BBE4014BDEC988876AE742C6014BD5BFF1E37EC0E2A72CDA736510B154CC852FD2D7FDF17078382831F12E14B95808977F946E16F030D5E5F763EE2BA20C93A588928AF6BC0BED59C65E144B9727893AE7C02F780113E10A339A025020DC58267291BE532753B648A354F1D150FF15F86BC04137C0780508DC93ABC750C66CEEABE0AB96380A36F8F517C7513DE049F7235FB0CC4F937C8BDE16DFC6E5B66253B5B1FAAFF8FFB30CD3C4793E61892BC4BD6A91820742D57379162662A0F67096A46789608D3B97F91F8D7BDC2435369F0B4F0CF66B5527FF50477D67FEE9603C06BB2E12EB4E9F858FD5CE38DBBB7B301B793AE0E1DEC32CDF3457559E0E58BC373B5B133EEC1B3128FFA94549551035052EDA085C123157E886B045CA955A4787C3BC565FE4DE181F1C57FFDC65797FB12C95F55644662BEA55E65B367A549F77AA443E2BBCA60EE08B6BE93E716F96AA1DA7035DBBDAF870751B0B192B3F9D0E8E8FCB8D331E884BE1793C340E0C97C2E3DF963C7C48B8B7DEFEFB67ED8972832BB350FD3D391A0D5601F213EFD38BCBA3DC66EA9090E5DD7C9397F2F3229958B74033FE5E114755086C902567F978E38C3639C738CE382F961827DF0CCE364231C2D53679D3DAA66F5ADBC19BD676F8A6B51DBD696DEFDFB4B6E337A94D841E7F295C0BEB02E89D6016EBE2601667E26016E3E160165FE16016DBE0601657E06016D1E360164D7785A5D2B549D6B0C7C4E28F1DE0EDB34F0F78FB64D303DE3EB7F480B74F253DE0ED33470F78FB44D103DE3E2FF480B74F034878B1EC73AE9431C394C6970B29D350A6DC49F90B1192850AA8D34242683EC5F298EE9CA958C520592E0068902ED3FFB78BE880603191E629AE2317CE423C66314F684E8187DFB9AFB27E87799E825253639E66B125406803C47CC1631EBA9CDC05C4E43CD175C22C98536938628FB4401E7A3F23A415966E5459A99F65E932B795A07240C0DC58522D9D18ED00732D12A2F8E524E73CF37D4E09BC2194A20612A5379A4594DD68165172A35944B98DD1A3A4612B9194D12B9194412C9194B12CC44C1ACB124919CB124919CB124914CB7B91FA7C730534EA78C5F3C29709D9283A138F2153EB10A2C9ADBC00EDDCB2983DC62C5A3AF9DD82D64520AEB273E9BD3AF764D3E80A479A9A68155DA8208830230A720D49EAC91594D2952B28A52F575022677E51EBFB7C01794998A1CDB279DA68F88ED9CD8CF959B1082732294B8994B8B6CC671127B4C6696653C9FD265F825F52AE47D7ED256AE21A48E4C6CD018EBEA12597AABDBE749F0807F8CBD788C72AEF7CA2C17D96BE2F9FB9478C9DA5B12C34698E19E371B731E353102D592212C0E9B8D8A89E9470BEB088E6FC6E7D2642C25EFDB41730E13BC40B99CBFB2FD7CEBD8CF2B43A0F1621F55CA6A90C68C1E535D53F7DE3F33F1336F54CA5FFE12BE5C99F515E4AD3C40B41359B1538E951E2D4825884826EEED6D0BFF2D7B964B14788BC8D79F16053CA29B13316443EA925D560FBAC8632AA359A86FE8DC522BF8646EAC57B3AA2711536C9E67F709768E8BC910EDD55B4AF59AAAFE9EAE539D17DFD1A9368B5526312AD54745FAB2928173BD5B9D79844E75E63929EFB85CF924458EF8EF783929E7D05FD29A74F94E29650E9CB7891F9C441ADA8B451ADA8B461957E16840979003494FAFC35F4A79C3EB5AA3494EA92A686FE25161E6D2F69226917692269FF682269E768227DCF103DE56510891EF5328844CF7B1544CA45884124D523FD0284F2769C4124D5A32692EA511349F5A889A47A9C7C74F862A116EEC47399C125D5A6C1259ED1C29407918C59FC4AC9FDE4F3474675E5B940DEC67291BFD723C3E21D05B2D577364FC9B38482492A816F7C4EDBC81C48DE42AA4BCDCCF7A5A4BC2CB99ED974F1FA63933B95D5EF48D134E6D6672E5F4ADFE3B1E514DBAF14CC8AD79736CFA6E3BDAC6BF1B84C9DD97275E3C5641D0E772B5E5DB4A895DDB1EAA61E391CB795FDC23D910555BBE1CB4687938E8431204C7724AC9736B5E2075D8AC3DA0F772CBE5EE8D78A1F75290E6B7FDFA5F804146F35D447163F35AAE6A85571ABC4D6A2D9A3F6E7352A4263035AA5B72ADEA4DCA356DDD50CE79CB96E7E3307766007E7D9211D2C688774F6A21DD5D99476543777DA39AD36BDE3DF45D278BB6097C72256CFDD804967DA6D9CFE3D9329787061DCF19DCA2BB5D80B13EE34C2261DEF44D6C62F7B80BB0D64764EB711CDCEE936B4D939BB8F715646F7C1CE8EEA36EAD939DD863F3B07370EC29908310E4208621C8410F4380851E871B0EF2AC5CEE9B65CB1737076871C9CDDFBAE64EC9CEE76070CBCDD210A6777C8C1D91D727076872B4784DD210461770841DB1DA2D07687289CDD21076777C8C1D91D727076871C9CDDFB64305606DEEE1085B33BE4E0EC0E3938BB4F29EC0E2108BB4308DAEE1085B63B44E1EC0E3938BB430ECEEE9083B33BE4E0EC0E39DDED0E1878BB4314CEEE9083B33BE4E0EC7E4061770841D81D42D0768728B4DD210A6777C8C1D91D727076871C9CDD21076777C8E96E77C0C0DB1DA27076871C9CDD210767F7430ABB4308C2EE1082B63B44A1ED0E5138BB430ECEEE9083B33BE4E0EC0E3938BB434E77BB0306DEEE1085B33BE4E0EC0E39AD8A2EEF66DB5E611921AF425B5F89E9FA3A5ED1BC3BF367216A17B63BF2AAF6D9811DDFFD3997F2C9697CD57832E94812735F487D43C1F2B886093FC2DD28FF7AB1FD45BC1D7E71A8D349952F20E97BECA08669A7E2E0C2D4B4D524667190E84E5BBD6116070BE769EB086F160713F1B47560D7C6AE9E9152D32020B40E5B06616461B44E0B06037640EB64609486F16F9D028CD230FCAD03BF51FAC0C967814DC44197001EAE9EBA069856151B98233BA655CDB03BADB768BAF5AB1DD3A983ED984E3D6DC774EF722B0BD9F7761E4E04765E0F35409FA2D4D0D3EE760C4A0D1083570360F55403E4F55303E4F550031C77516A8018941A7ACE02760C5E0D80D5530D90D74F0D90D7430D701E45A90162506A8018941A28160756564F35405E3F35405E0F35C055294A0D10835203C4A0D40031783500564F35405E3F35405E0F3580AB073835400C4A0D10835203C4E0D500583DD50079FDD40079AD6AD057A17AA6880603B166344A2316074669C42C6094C6A68806A24F8A6860FAA488B03B7BA48866BFF64811CD0EEE91229A3DDD2345045DDE23456CECFB1E2962A3087AA48876352052C42635F4B47B8F14B1490D8814D1AA06448AB8550D881471AB1A1029A25D0D8814B1490D8814B1490D3D67811E29A2550D881471AB1A1029E25635205244BB1A102962931A102962931A102962931A2816073D52C4AD6A40A4885BD5804811ED6A40A4884D6A40A4884D6A40A4884D6A40A48856352052C4AD6A40A4885BD5804811ED6A40A4884D6A40A4884D6A40A4884D6A40A48856352052C4AD6A40A4885BD5604D11F38F1A9A9F30D4DB9E8B6F87AA22E96BC4F3CF3E186FBC79C5CF4F97B784F58157DEE980AD3F4498B7C7293F05597E7F70DDF6F21EF2AA720D68ACD55DAA6ADDF257E86CB50E9BABB5FC46F6BA19EB585445CC00AF6F901B256A77C477687F9AF7C5B6B68FB685ACFC6DBB6D2D3E3EEEDE64BD3D9DFBEBEF6616FF5F859EC23E979F862C4EC07B615505D56117DCF7BFB0FA373753196D2F5A68962FD2E2B0D1F0FDB603E7C54F77B613633D42B520F32EDA6C77B9AD08C1F63E2CBE75523E3661EBC7B1AD1F8BB791A9BB707B8B6B5E75B344C5523B7BB3D5F73777234BC38B5DEB36CC99AAFA6B58ED66B5072844F8542B37B478BDE8B24478D5D1C3E1D9E8E0E3E185717C545325F896ABF125D7C9FAB3AE8D5F727D3E115AD08BFC67ADAF7591A3E171ED803FDCAA254A71CB552B6ADF80AD7D99F7C3E67779F36F0D043C716EF8B3732703A6DF27D69FDE857BCC9A8D4FEC4ECD7AE35D14591B15DBFAD7323AEA7DCE8F7FFEF8CF8F7FFDF8F7969E1E6EEBE9C1CEFDFA7F17C49A49D6469E34876BE3AD6F7BB8B65A7D32257346A1ED7C44CD1F191CD6E2E2E6BFFEF39266CC2F7F4C040A9B6E009916BFBD6F15D9D4290EB0866C53489B222B2AA01B53CCC80D2DC341BE6052F6DA6940985B24F9FEA7FABA8A4A5BDC77B03818B39B7BE07FEB756494577FAA55ED7F01504B03040A0000000000C5B4474A0000000000000000000000000B008500776F72642F7468656D652F53447000C000000000080056833AB26364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C450C20096169660F8CF28CF001203A95500A905B1854520E28C107121A8DA950C42286A15416C011186FD8CC270B5DC20521AE452C607C8620055540D000721229A5821229A5821229A58504B03041400000008000265484A4C555FC79B0600002F25000015007C00776F72642F7468656D652F7468656D65312E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58ED5ACF8ED3461CBEF31423DF43ECC48E134440899340CB2E2076A1E2387126F1B0634F349EEC6E8490D072ACD4AA2AAD7A2852DB4B0F55DB95A0EA05DE213CC3B6542D9578858EED4DD6E33893002D44945D69379E99EF9BDF9FF9CD37767CF6FCBE4FC02E6221A6415D334EEB1A40814B7B3818D4B5EBDB9D4255032187410F121AA0BA3646A176FEDCA9B3F00CF7908F808007E11958D73CCE87678AC5D015CD303C4D8728107D7DCA7CC8C5251B147B0CEE095A9F144BBA5E29FA10071A08A02F5827DF4D7E993C9E1C822BFD3E769176EE1400D329DA44FC097818B5C5AD2E615B6E3CF931F8DBA70793C3C993C9A3C9E1D3BBE2F313F1FF532D191F237A3BC6F42ABE0EC7A14318D885A4AE09937A746F1BED730D101872D151D7F4F8472BCE388A1289A0207C19658AAE13FFC8742982D8C2924CC706DD199F695A66A591B5A62459A380B7ED76A55DC9CE9E8643D7151136165358CD5AB365C91419D08C466549CB6E958D3C9A796BCA8B691A56F49B47539EA33117D3743ACE5C9233A0198DA5CA8E5D72CC3C1A6B8EA6B298C6D61B2DD3CEA3A9A4683C82839DC524BA55293B99004B1001E8537251CD52B3CC8E5D92596454D4322BC35961F669C05FB2327D788BB28EC049D610C87100F87888FAD0153C0E24B8CB30D8C0034F94E910063414CD7A49EFE865F137FA35E34FA93CC44C08A668327D6EB8B82F7205842EC3435ED73E14136AA9B12F1EFFF8E2F1437074F0E8E8E0D7A37BF78E0E7E56C12FC26090863FFFFEB3BF1FDC057F3DFCE6F9FD2F9600C334F0F79F3EFEEDC9E74B103C8D78F6E5E11F8F0E9F7DF5C99F3FDC57E11A0C76D3B86DECA3105C467BE01AF585F3AA295197BD2274DB83380D6D048310063002AB606DEE49B0CB6348A00AD04472026E30B1412B111746B724A7B63C36E25885B8E4F912629352D2A44C1D804B9119E9D88D82C112BBD8280DB806E1AED22C27B384DAA3A1A84FAC9CC4F190E4CA552256151CA0007110F5D11D8454F89B184BF9D9C42EA321ED7370138326C4EA406EE32ECF475FC4BE48F45869BB58525244376F802625CA095B6857868872854439092252162EC01187BEDA2BE893346403724FE9C8D698B952E2422E16D300110ADA3D14864AF01536965CBA24F6CF252B6B938C7D19C238DE51423620A569488BEE381EF4876ABF70E0A5411F843BA25220B84AB9DA3E2AD770742D120B83E52BEA0646FC1577A8EB4270F21763D43362CA5A4554DE43C6A40F516ABA4844E7F42FD2441CACAE891935B4DE9A1A0A9179F6F583774C071B0CABB782ACFA2D056435CFA1AC87DF0DC96BC151701589F27EAF78EF15EFBDE2AD91E22DDD95FE7B9D93352DB9A39CDE2D9EDC40FA2F7BFFD8C7846CF131411BA12C97A10855AF237A4F5A93F6987F76AB3BF4C447C9BB622E5620070CC68D8051FE11E6DE960787C24643CBCC3008255B66AD604843A1D29ADCB5D8A8ECB8E41430F237692F196618F2432A9912F29381E258B070A03855F06458C5CE1D1547646A60C6AF62E4D8425FADD8BE7FCF5F951BB2BFE555FCB5F347BDBABF86FED61CAEADE270D5787D879396CC0A8FEC168753183D33B6CC240A627F8004F5A2159F29AF6921AD5F75ADBC88E42C9556097ECD5CBFEA92FC55ED26B2BFAA6DC7833DA41EB73EF55553548D149AD26A1EDBD5B5ACAF586C737432620D72C59304604FE841D912D3B87058D7FAE2EE537CF48762BE303A96403208EA9ACB59B63E73757725E55DA8BD317AC842DE82A19780E351197074C8E08801827DB1D5CD2DBEF85B8F20C74DA364EBFF0B3F6BFABB9BCFE42A6785A37E1FB93C7795A7BA3213273D627C66BE5CC49B669A4B041D89306D79BD3DD02523760D8A9C5AB611E5BA87433E4B7C0FB3D4EE7192F08CE2E6EFAFD2974CF9DB703C1092A1078F8F938AE3554237BF17CE5CC92EA31CEF178431D32CAF86EEA0F3E66E185E8A712EABA99343DE29302B51F6BC442DD09D35BFC349F9AD388049BE5BABC9732D5F9E573ED0BDD5A35A2A2C0A37A4B094570CCBCAE7BE75BC5F4A39B260C359F938B70EE7B4BC0D2A3EBFF9A9672551C3DCAB319110746F896DAF85FA704478583C6E45FB9C4167FA65FD548A928E9339E24B3062B8AEDDD6AD86E9942CA7A057AD76C12C9B7AA16A35CA858665958DB665E8AD66E9CEC95318EEF9869518D4813E26E3E39782E2F6B91783FCE9A3A5D32EF58B347EDFA71883E317838C92F46250F23E10D88EFA358045186F574A9D5AB9D6AC146AE546A760B69AD542CDA9340BAD8A63B73A2DC7AAD63A7734B01B0F361B65C7ACB4AB858AE13805B3A2475E546B05DB2C951AA6DDA8B6CDC69D696262E9D8E7D3104FE3330BF7B953FF00504B03041400000008000265484AA5DF16EC05010000F801000014007C00776F72642F77656253657474696E67732E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A5895D1C14A03311006E07B9F22E4DECDB6A8C8D26D41A4E24504F501D2EC6C1BCC64C22475AD4FEFB0D68A78A9B70C93F998E15FACDE31A837E0EC29B67A56D55A4174D4F9B86DF5CBF37A7AAD552E3676365084561F20EBD572B2189A01364F508A7CCC4A90981B74ADDE95921A63B2DB01DA5C518228CD9E186D9192B7062DBFEED3D411265BFCC6075F0E665ED757FAC8F0390AF5BD77704B6E8F10CB386F18828814F3CEA7FCAD0DE768037197981CE42CF760F8F2D0FA786266177F20F48E29535F2A39E6B8D148C9F8AC1E5F187E80CBFF01F31380AEB9DF4662BB0992806CA204D3CB89521203A5E2D17FC09AF88669C8C0E6D8B121D0F0F87027F5C2FCCA6B39F904504B03040A0000000000C5B4474A0000000000000000000000000B008500776F72642F5F72656C732F53447000C000000000080056833AB26364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C450C20096169660F8CF28CF001203A95500A905B1854520E28C107121A8DA950C42286A15416C011186FD8CC270B5DC20521AE452C607C8620055540D000721229A5821229A5821229A58504B03041400000008000265484A97E085C7EF000000410300001C007C00776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C7353446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58ADD2CB4EC3301005D07DBEC29A3D71D20242284E37A852B7103EC04D260FD5B12DCFF0C8DF631501A900B58B2CE75A737D2CB9D8BC8F46BC62A0C15905799A81405BBB66B09D82E76A7B75078258DB461B6751C184049B32291ED1688E3BD40F9E442CB1A4A067F6F75252DDE3A829751E6D3C695D1835C73174D2EBFAA03B94AB2CBB9561DE016522C449ADD8350AC2AE5983A8268F97D4BBB61D6A7C70F5CB8896FFB845BEE1FE0999E3F328D6EAD0212B9885696C04F9AF65B5A4857E41E83245BEA882278373C3713E23B85952C071177F00C7F133CCCF30AE9764B4CE72A5F76646F98EBE1C853CF9F865F201504B03041400000008000265484A17980729550100003F05000013007C005B436F6E74656E745F54797065735D2E786D6C53446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58B594CB6EC2301045F77C85E52D4A0C5D545595C0A28F658B54FA01C69E8055BF649BD7DF7742685A5550A2029B48D1CCBDF78CE57131DE184D5610A272B6A4C37C400958E1A4B2F392BE4F9FB33B4A62E25672ED2C94740B918E47BD62BAF510098A6D2CE922257FCF58140B303CE6CE83C54AE582E1097FC39C792E3EF81CD8CD6070CB84B3096CCA52ED41473D428A47A8F85227F2B4C14AC31240474A1E9ADE3AAEA4DC7BAD044F58672B2B7F0565FB901C95BB9EB8503EF6B181B2632175F178C6B7F4158F28280964C2437AE1061BD9DA05C9A4134B83E2FC6FA703B4AEAA9480565FBBF9E004C488676F74DE560C57B6DF0125A6AD86787990C6B71301A4849A6B30EC9DBB50AC61F67635901FE65D582A8C9EF29986CB93B4D65D38126E2634DFE1D9283B9B13A9D83C09CE475CF6F08FE1BF56B9566738B68790D4C94BD886A2FBD95342FD4A489007E20BB67BFE46BD4F504B03040A0000000000C5B4474A000000000000000000000000060085005F72656C732F53447000C000000000080056833AB26364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C450C20096169660F8CF28CF001203A95500A905B1854520E28C107121A8DA950C42286A15416C011186FD8CC270B5DC20521AE452C607C8620055540D000721229A5821229A5821229A58504B03041400000008000265484A55DB6AAFEB000000580200000B007C005F72656C732F2E72656C7353446700AC0000000008001CE19BBD6364606911616060306080001F206664053359458184C2F15427AE88E0BB8ABF756FBE64C62DC7C8C4C0C0C490C0C00292159060F8CF28CF001203A95500A905B1054420E28C107121A8DA950C42286A15A16AF7330AC3D57203090055540D000774E79A58D07BCE1221229A58AD92CD6AC3300C80EF790AA37BA3B48331469C5EC6A0B731B20710B6F24313DBD86AD7BEFD3CD8D802EBD6C38E96A54F9F84EAED699ED491631ABDD3B02E2B50EC8CB7A3EB35BCB48FAB3B5049C8599ABC630D674EB06D8AFA9927925C9386312495212E691844C23D623203CF944A1FD8E59FCEC799243F638F81CC9E7AC64D55DD62FCCE80A6506A81553BAB21EEEC0DA8F61CF81ABCEFBAD1F0833787999DFCD005F924EC2CDB5588B93ECA98E7512DC59E4583F5E629871352086546035E94DA5C2F7579669C59C892101A1FF977A5F78C3F9CD6FFB9A865C697D0AB8F16ED47F853A8C6C53D34C51B504B0102170B0A0000000000C5B4474A000000000000000000000000090011000000000000001000FF4100000000646F6350726F70732F53440400C0000000555405000721229A58504B0102170B1400000008000265484A3E8975CE7E01000002030000100011000000000001002000B681AC000000646F6350726F70732F6170702E786D6C53440400AC000000555405000774E79A58504B0102170B1400000008000265484AF37A1D4158010000CC020000110011000000000001002000B681D4020000646F6350726F70732F636F72652E786D6C53440400AC000000555405000774E79A58504B0102170B0A0000000000C5B4474A000000000000000000000000050011000000000000001000FF41D7040000776F72642F53440400C0000000555405000721229A58504B0102170B140000000800046E484A10F6F65A5B02000075070000110011000000000001002000B6817F050000776F72642F646F63756D656E742E786D6C53440400AC000000555405000767F79A58504B0102170B1400000008000265484AB5D52725A90100004B050000120011000000000001002000B68185080000776F72642F666F6E745461626C652E786D6C53440400AC000000555405000774E79A58504B0102170B1400000008000265484AC27C1DDDC8030000FB0A0000110011000000000001002000B681DA0A0000776F72642F73657474696E67732E786D6C53440400AC000000555405000774E79A58504B0102170B1400000008000265484A97A48381310C0000487F00000F0011000000000001002000B6814D0F0000776F72642F7374796C65732E786D6C53440400AC000000555405000774E79A58504B0102170B0A0000000000C5B4474A0000000000000000000000000B0011000000000000001000FF41271C0000776F72642F7468656D652F53440400C0000000555405000721229A58504B0102170B1400000008000265484A4C555FC79B0600002F250000150011000000000001002000B681D51C0000776F72642F7468656D652F7468656D65312E786D6C53440400AC000000555405000774E79A58504B0102170B1400000008000265484AA5DF16EC05010000F8010000140011000000000001002000B6811F240000776F72642F77656253657474696E67732E786D6C53440400AC000000555405000774E79A58504B0102170B0A0000000000C5B4474A0000000000000000000000000B0011000000000000001000FF41D2250000776F72642F5F72656C732F53440400C0000000555405000721229A58504B0102170B1400000008000265484A97E085C7EF000000410300001C0011000000000001002000B68180260000776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C7353440400AC000000555405000774E79A58504B0102170B1400000008000265484A17980729550100003F050000130011000000000001002000B681252800005B436F6E74656E745F54797065735D2E786D6C53440400AC000000555405000774E79A58504B0102170B0A0000000000C5B4474A000000000000000000000000060011000000000000001000FF41272A00005F72656C732F53440400C0000000555405000721229A58504B0102170B1400000008000265484A55DB6AAFEB000000580200000B0011000000000001002000B681D02A00005F72656C732F2E72656C7353440400AC000000555405000774E79A58504B05060000000010001000E1040000602C00000000";

// create new docx file
// https://stackoverflow.com/questions/21819782/writing-hex-to-a-file
void createNewDocx(std::string fileName) {
    // create new docx file from hex
    std::string hex = hexEmptyTemplate;
    
    std::basic_string<uint8_t> bytes;

    for (size_t i = 0; i < hex.length(); i += 2)
    {
        uint16_t byte;
        std::string nextbyte = hex.substr(i, 2);
        std::istringstream(nextbyte) >> std::hex >> byte;
        bytes.push_back(static_cast<uint8_t>(byte));
    }
    
    std::string result(begin(bytes), end(bytes));
    
    std::ofstream output_file(fileName.c_str(), std::ios::binary | std::ios::out);
    if (output_file.is_open())
    {
        output_file << result;
        output_file.close();
    }
    else
    {
        std::cout << "Error could not create file." << std::endl;
    }
}

wordKit::SectionProperty::SectionProperty() {
    
}

std::string wordKit::SectionProperty::encode() {
    std::string content = "";
    
    {
        std::string orientation = "";
        if(isVertical) {
            orientation = "portrait";
        } else {
            orientation = "landscape";
        }
        
        content +=
        "<w:pgSz w:h=\"" + std::to_string(height) +
        "\" w:w=\"" + std::to_string(width) +
        "\" w:orient=\"" + orientation + "\"/>";
    }
    {
        
        content +=
        "<w:pgMar w:left=\"" + std::to_string(marginLeft) +
        "\" w:top=\"" + std::to_string(marginTop) +
        "\" w:right=\"" + std::to_string(marginRight) +
        "\" w:bottom=\"" + std::to_string(marginBottom) +
        "\" w:header=\"" + std::to_string(marginHeader) +
        "\" w:footer=\"" + std::to_string(marginFooter) + "\"/>";
//        "\" w:gutter=\"" + std::to_string(marginGutter) + "\"/>";
    }
    
    const std::string openKey = "<w:sectPr>";
    const std::string closeKey = "</w:sectPr>";
    return openKey + content + closeKey;
}

wordKit::Document::Document(std::string fileName) {
    createNewDocx(fileName);
    this->name = fileName;
    this->zip = zip_open(fileName.c_str(), 0, 'a');
};

wordKit::Document::~Document()  {
    this->save();
    zip_close(this->zip);
    
    for(auto element : elements)
        delete element;
    
    elements.clear();
}

void wordKit::Document::removeAllElements() {
    this->elements.clear();
}

void wordKit::Document::appendElements(std::vector<Element*> elements) {
    this->elements.insert(this->elements.end(), elements.begin(), elements.end());
}

void wordKit::Document::save() throw() {
    // encode content
    std::string content = "";
    for(auto element : elements) {
        content += element->encode();
    }
    
    const std::string property = this->property->encode();
    const std::string startDoc = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><w:document xmlns:ve=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:body>";
    const std::string endDoc = "</w:body></w:document>";
    // open xml
    zip_entry_open(zip, "word/document.xml");
    {
        // set new document content
        const std::string document = startDoc + content + property + endDoc;
        const char *buf = document.c_str();
        zip_entry_write(zip, buf, strlen(buf));
    }
    // close xml
    zip_entry_close(zip);
}
